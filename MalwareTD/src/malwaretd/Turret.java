package malwaretd;

import java.awt.Image;

import jgame.Context;
import jgame.GObject;
import jgame.GSprite;
import jgame.controller.ConstantMovementController;
import jgame.listener.FrameListener;
import jgame.listener.TimerListener;

public abstract class Turret extends GSprite {
        public Turret(Image image, int damage, int firerate) {
                super(image);
                
                this.addListener(new FrameListener(){

					@Override
					public void invoke(GObject target, Context context) {
						// TODO Auto-generated method stub
						target.face(getParent().getWidth()/2, getParent().getHeight()/2);
						target.setRotation(target.getRotation());
						
						
						
					}
				
                	
                });
                this.addListener(new TimerListener(firerate) {

					@Override
					public void invoke(GObject target, Context context) {
						// TODO Auto-generated method stub
						fireBullet();
					}
                	
                });
        }
        
 //       public abstract int fireRate();
        public abstract Bullet createBullet();
        public abstract double getBulletSpeed();
        public abstract int getBulletPowa();
        
        
        
        public void fireBullet()
        {
        	final Bullet b = createBullet();
        	b.setRotation(this.getRotation());
        	final ConstantMovementController c = ConstantMovementController.createPolar(getBulletSpeed(), getRotation());
        	b.addController(c);
        	snapAnchor(b);
        	b.moveAtAngle(getWidth() / 2 + 20, getRotation());
        	this.addSibling(b);
        }
}